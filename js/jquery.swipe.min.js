!function(a){"function"==typeof define&&define.amd?define(["Hammer","jquery"],a):a(Hammer,jQuery)}(function(a,b){function c(){var a=document.createElement("div"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]}}function d(a,c){this.$el=b(a),this.$carousel=this.$el.find(c.carousel),this.opts=c,this.init()}var e="onorientationchange"in window?"orientationchange":"resize";d.DEFAULTS={offsetCount:2,staticCount:null,showNav:!1,autoHeight:!0,carouselContent:".carousel-content",carousel:".carousel-content > ul",carouselItem:"li",carouselPrev:".carousel-prev",carouselNext:".carousel-next",disabledNav:"disabled"},d.prototype.init=function(){var a=this.opts,b=this,c=this.$el,d=this.$carousel;this.index=0,this.$carouselPrev=c.find(a.carouselPrev),this.$carouselNext=c.find(a.carouselNext),this.carouselLength=d.find(a.carouselItem).length,this._getImageWidth().done(function(){b._setItemWidth()._setWidth()._setHeight()._initOffsetCount()._initNav()._initFuncBind()._show()})},d.prototype._show=function(){this.$carousel.css({visibility:"visible"})},d.prototype._initFuncBind=function(){var a,d=this,f=d.opts,g=d.$el,h=d.$carousel,i=d.$carouselPrev,j=d.$carouselNext;return h.hammer().on("swipeleft",function(){d.forWards()}).on("swiperight",function(){d.backWards()}).on(c().end,function(){d._afterSlide(),b.isFunction(f.callback)&&f.callback(Math.abs(d.index),g,f)}),i.hammer().on("tap",function(){d.backWards()}),j.hammer().on("tap",function(){d.forWards()}),b(window).on(e,function(){clearTimeout(a),a=setTimeout(function(){d.index=0,d._setItemWidth()._initOffsetCount()._initNav().nav(d.index).slide()._afterSlide(d._setWidth)},200)}),this},d.prototype._getImageWidth=function(){var a,c=this.opts,d=this.$carousel,e=d.find(c.carouselItem+":first"),f=(e.find("img"),this);return a=b.Deferred(),e.height()?(f.normalItemWidth=e.width(),a.resolve()):e.find("img").on("load",function(){f.normalItemWidth=e.width(),a.resolve()}),a},d.prototype._setItemWidth=function(){var a=this.$el,b=this.opts,c=this.$carousel;c.find(b.carouselItem).first();var d;return 1==b.staticCount?(d=a.find(b.carouselContent).width(),c.find(b.carouselItem).css({width:d}),this.currentCount=b.staticCount,this.itemWidth=d):(d=this.normalItemWidth,this.currentCount=Math.floor(a.width()/d),d=a.width()/this.currentCount,c.find(b.carouselItem).css({width:d}),this.itemWidth=d),this},d.prototype._setWidth=function(){var a=this.$carousel;return this.$el,a.css({width:this.carouselLength*this.itemWidth}),this},d.prototype._setHeight=function(){var a=this.$el,b=this.opts;return b.autoHeight||a.css({height:a.find(b.carouselContent).height()}),this},d.prototype._initNav=function(){var a=this.$el,b=this.opts;return(this.carouselLength>b.offsetCount||b.showNav)&&(this.$carouselPrev.css({top:a.height()/2}).show(),this.$carouselNext.css({top:a.height()/2}).show()),this},d.prototype._initOffsetCount=function(){var a=this.opts,b=this.$el,c=d.DEFAULTS.offsetCount;return null!==a.staticCount?a.offsetCount=a.staticCount:(c==a.offsetCount||a.prevOffsetCount==a.offsetCount)&&(a.offsetCount=Math.floor(b.width()/this.itemWidth),a.prevOffsetCount=a.offsetCount),this},d.prototype.nav=function(a){void 0!==typeof a&&(this.index=a);var b=this.opts,a=Math.abs(this.index),c=this.carouselLength,d=(this.currentCount,b.disabledNav),e=b.staticCount?b.staticCount:b.offsetCount,f=this.$carouselPrev,g=this.$carouselNext;return 0==a?(f.addClass(d),g.removeClass(d)):a+e>=c?(g.addClass(d),f.removeClass(d)):(f.removeClass(d),g.removeClass(d)),this},d.prototype.backWards=function(){var a=this.opts,b=a.disabledNav,c=this.$carouselPrev;c.hasClass(b)||(this.index+=Math.abs(this.index)<a.offsetCount?Math.abs(this.index):a.offsetCount,this.nav(this.index).slide())},d.prototype.forWards=function(){var a=this.opts,b=a.disabledNav,c=this.carouselLength,d=this.currentCount,e=a.offsetCount,f=this.$carouselNext;f.hasClass(b)||(this.index-=c-e-Math.abs(this.index)<=e?e>d?c-d:c-e-Math.abs(this.index):e,this.nav(this.index).slide())},d.prototype.slide=function(){var a,b=(this.$el,this.index);return a=this.itemWidth*b,this.$carousel.css({transform:"translateX("+a+"px)"}),this},d.prototype._afterSlide=function(){for(var a=Array.prototype.slice.call(arguments),c=0,d=a.length;d>c;c++)b.isFunction(a[c])&&a[c].call(this);return this},b.fn.swipe=function(a){var c;return this.each(function(){var e=b.extend({},d.DEFAULTS,"object"==typeof a&&a),f=b(this),g=f.data("swipe");g||f.data("swipe",c=new d(this,e)),"string"==typeof a&&g[a]()}),c}});